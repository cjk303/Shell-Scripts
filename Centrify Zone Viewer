# Import the Centrify PowerShell module
Import-Module Centrify.DirectControl.PowerShell

# Get all managed computers
$computers = Get-CdmManagedComputer

# Extract Zone name (first CN=) and show results
$results = foreach ($computer in $computers) {
    $zoneName = "Unknown"

    if ($computer.Zone -match "CN=([^,]+)") {
        $zoneName = $matches[1]
    }

    [PSCustomObject]@{
        ComputerName = $computer.Name
        Zone         = $zoneName
    }
}

# Display result
$results | Format-Table -AutoSize

# Optional: Export to CSV
# $results | Export-Csv -Path "Centrify_Computers_With_Simple_Zones.csv" -NoTypeInformation
