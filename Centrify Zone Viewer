# Function to get the Centrify zone and domain of a computer from a remote management node
function Get-RemoteCentrifyZoneAndDomain {
    param (
        [Parameter(Mandatory=$true)]
        [string]$ComputerName,

        [Parameter(Mandatory=$true)]
        [string]$RemoteHost
    )

    $scriptBlock = {
        param($CompName)

        Import-Module Centrify.DirectControl.PowerShell

        # Get the managed computer object
        $computer = Get-CdmManagedComputer -Name $CompName
        if ($null -eq $computer) {
            Write-Output "‚ùå Computer '$CompName' not found in Centrify."
            return
        }

        # Get the zone
        $zone = Get-CdmZone -Guid $computer.ZoneGuid
        $zoneName = if ($zone) { $zone.Name } else { "Unknown" }

        # Get the domain (from AD path)
        $domainName = $null
        if ($computer.DistinguishedName -match "DC=.+") {
            $domainComponents = ($computer.DistinguishedName -split ",") | Where-Object { $_ -like "DC=*" }
            $domainName = ($domainComponents -replace "DC=") -join "."
        } else {
            $domainName = "Unknown"
        }

        # Output result
        Write-Output "‚úÖ Computer: $($computer.Name)"
        Write-Output "üåê Domain : $domainName"
        Write-Output "üì¶ Zone   : $zoneName"
    }

    try {
        Invoke-Command -ComputerName $RemoteHost -ScriptBlock $scriptBlock -ArgumentList $ComputerName
    }
    catch {
        Write-Error "‚ùó Remote execution failed: $_"
    }
}

# Example usage
Get-RemoteCentrifyZoneAndDomain -ComputerName "YOUR-COMPUTER-NAME" -RemoteHost "p016cfyammgmt01"
